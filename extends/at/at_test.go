package at

import (
	"encoding/hex"
	"testing"

	"github.com/stretchr/testify/assert"
)

type atTest struct {
	code string
	data string
	err  error
	s    *stateMachine
}

var atTests = []atTest{
	atTest{
		code: "01000000000000000000000000010100000001000000000000000102000000020000000000000001030000000300000000000000010400000004000000000000000105000000050000000000000001060000000600000000000000010700000007000000000000000108000000080000000000000001090000000900000000000000010a0000000a00000000000000010b0000000b00000000000000010c0000000c00000000000000010d0000000d00000000000000010e0000000e00000000000000010f0000000f0000000000000006000000000100000006010000000200000006020000000300000006030000000400000006040000000500000006050000000600000006060000000700000006070000000800000006080000000900000006090000000a000000060a0000000b000000060b0000000c000000060c0000000d000000060d0000000e000000060e0000000f00000028",
		data: "010000000000000003000000000000000500000000000000070000000000000009000000000000000b000000000000000d000000000000000f00000000000000110000000000000013000000000000001500000000000000170000000000000019000000000000001b000000000000001d000000000000000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0101000000f0ffffffffffffff01040000000f000000000000000107000000ffffffffffffffff010a000000ffffffffffffffff010d000000f0ffffffffffffff01100000000f000000000000000113000000ffffffffffffffff0116000000ffffffffffffffff0119000000f0ffffffffffffff011c0000000f00000000000000011f000000ffffffffffffffff0122000000ffffffffffffffff0125000000f0ffffffffffffff01280000000f00000000000000012b000000ffffffffffffffff012e000000ffffffffffffffff0131000000f0ffffffffffffff01340000000f000000000000000137000000ffffffffffffffff013a000000ffffffffffffffff013d0000000f0000000000000006010000000400000006040000000700000006070000000a000000060a0000000d000000060d0000001000000006100000001300000006130000001600000006160000001900000006190000001c000000061c0000001f000000061f0000002200000006220000002500000006250000002800000006280000002b000000062b0000002e000000062e0000003100000006310000003400000006340000003700000006370000003a000000063a0000003d00000028",
		data: "0000000000000000ffffffffffffffff000000000000000000000000000000000e0000000000000000000000000000000000000000000000feffffffffffffff00000000000000000000000000000000efffffffffffffff00000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000e0000000000000000000000000000000000000000000000feffffffffffffff00000000000000000000000000000000efffffffffffffff00000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000e0000000000000000000000000000000000000000000000feffffffffffffff00000000000000000000000000000000efffffffffffffff00000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000e0000000000000000000000000000000000000000000000feffffffffffffff00000000000000000000000000000000efffffffffffffff00000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000e0000000000000000000000000000000000000000000000feffffffffffffff000000000000000000000000000000000e00000000000000000000000000000000000000000000000f0000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "010100000001030507090b0d0f01040000000020406080a0c0e0010700000001030507090b0d0f010a0000000020406080a0c0e0010d00000001030507090b0d0f01100000000020406080a0c0e0011300000001030507090b0d0f01160000000020406080a0c0e0011900000001030507090b0d0f011c0000000020406080a0c0e0011f00000001030507090b0d0f01220000000020406080a0c0e0012500000001030507090b0d0f01280000000020406080a0c0e0012b00000001030507090b0d0f012e0000000020406080a0c0e0013100000001030507090b0d0f01340000000020406080a0c0e0013700000001030507090b0d0f013a0000000020406080a0c0e0013d00000001030507090b0d0f06010000000400000006040000000700000006070000000a000000060a0000000d000000060d0000001000000006100000001300000006130000001600000006160000001900000006190000001c000000061c0000001f000000061f0000002200000006220000002500000006250000002800000006280000002b000000062b0000002e000000062e0000003100000006310000003400000006340000003700000006370000003a000000063a0000003d00000028",
		data: "00000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef0000000000000000000000000000000001030507090b0d0f00000000000000000000000000000000",
	},
	atTest{
		code: "01000000005555555555555555010100000022222222222222220102000000999999999999999901100000006666666666666666011100000011111111111111110112000000999999999999999901200000001111111111111111012100000022222222222222220122000000999999999999999901300000004444444444444444013100000011111111111111110132000000999999999999999906000000000100000006000000000100000006100000001100000006100000001100000006100000001100000006200000002100000006200000002100000006200000002100000006200000002100000006300000003100000006300000003100000006300000003100000006300000003100000006300000003100000028",
		data: "9999999999999999222222222222222299999999999999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000999999999999999911111111111111119999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000099999999999999992222222222222222999999999999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009999999999999999111111111111111199999999999999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "013e000000ffffffffffffffff013f000000ffffffffffffffff063e0000003f000000063f0000004000000028",
		data: "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000feffffffffffffffffffffffffffffff",
		err:  ErrOverflow,
	},
	atTest{
		code: "06ffffffffffffffff28",
		err:  ErrOverflow,
	},

	atTest{
		code: "01000000000f0000000000000001010000000e0000000000000001020000000d0000000000000001030000000c0000000000000001040000000b0000000000000001050000000a0000000000000001060000000900000000000000010700000008000000000000000108000000070000000000000001090000000600000000000000010a0000000500000000000000010b0000000400000000000000010c0000000300000000000000010d0000000200000000000000010e00000001000000000000000b00000000010000000b01000000020000000b02000000030000000b03000000040000000b04000000050000000b05000000060000000b06000000070000000b07000000080000000b080000000a0000000b090000000a0000000b0a0000000b0000000b0b0000000c0000000b0c0000000d0000000b0d0000000e00000028",
		data: "0e000000000000000c000000000000000c0000000000000008000000000000000a0000000000000008000000000000000800000000000000000000000000000005000000000000000400000000000000040000000000000000000000000000000200000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0101000000ffffffffffffffff0104000000ffffffffffffffff01070000000000000000000000010a000000ffffffffffffffff010d000000ffffffffffffffff011000000000000000000000000113000000ffffffffffffffff0116000000ffffffffffffffff01190000000000000000000000011c000000ffffffffffffffff011f000000ffffffffffffffff012200000000000000000000000125000000ffffffffffffffff0128000000ffffffffffffffff012b0000000000000000000000012e000000ffffffffffffffff0131000000ffffffffffffffff013400000000000000000000000137000000ffffffffffffffff013a000000ffffffffffffffff013d00000000000000000000000b01000000040000000b04000000070000000b070000000a0000000b0a0000000d0000000b0d000000100000000b10000000130000000b13000000160000000b16000000190000000b190000001c0000000b1c0000001f0000000b1f000000220000000b22000000250000000b25000000280000000b280000002b0000000b2b0000002e0000000b2e000000310000000b31000000340000000b34000000370000000b370000003a0000000b3a0000003d0000000b3d0000003d00000028",
		data: "0000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01010000000123456789abcdef0104000000ffffffffffffffff01070000000123456789abcdef010a000000ffffffff00000000010d0000000123456789abcdef0110000000000000000000000001130000000123456789abcdef0116000000ffffffffffffffff01190000000123456789abcdef011c000000ffffffff00000000011f0000000123456789abcdef0122000000000000000000000001250000000123456789abcdef0128000000ffffffffffffffff012b0000000123456789abcdef012e000000ffffffff0000000001310000000123456789abcdef0134000000000000000000000001370000000123456789abcdef013a000000ffffffffffffffff013d0000000123456789abcdef0b01000000040000000b04000000070000000b070000000a0000000b0a0000000d0000000b0d000000100000000b10000000130000000b13000000160000000b16000000190000000b190000001c0000000b1c0000001f0000000b1f000000220000000b22000000250000000b25000000280000000b280000002b0000000b2b0000002e0000000b2e000000310000000b31000000340000000b34000000370000000b370000003a0000000b3a0000003d0000000b3d0000003d00000028",
		data: "00000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456700000000000000000000000000000000000000000123456700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456700000000000000000000000000000000000000000123456700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456700000000000000000000000000000000000000000123456700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef00000000000000000000000000000000",
	},
	atTest{
		code: "01000000009999999999999999010100000088888888888888880102000000ffffffff8888888801100000007777777777777777011100000055555555555555550112000000ffffffff5555555501200000006666666666666666012100000044444444444444440122000000ffffffff4444444401300000003333333333333333013100000011111111111111110132000000ffffffff111111110b00000000010000000b00000000010000000b10000000110000000b10000000110000000b10000000110000000b20000000210000000b20000000210000000b20000000210000000b20000000210000000b30000000310000000b30000000310000000b30000000310000000b30000000310000000b300000003100000028",
		data: "88888888888888888888888888888888ffffffff88888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000055555555555555555555555555555555ffffffff55555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044444444444444444444444444444444ffffffff44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111ffffffff111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "013e000000ffffffff00000000013f000000ffffffffffffffff0b3e0000003f0000000b3f0000004000000028",
		data: "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000ffffffffffffffff",
		err:  ErrOverflow,
	},
	atTest{
		code: "0bffffffffffffffff28",
		err:  ErrOverflow,
	},

	atTest{
		code: "0100000000030000000000000001010000000300000000000000230000000001000000170102000000dddddddddddddddd0500000000230000000001000000170103000000eeeeeeeeeeeeeeee04000000000400000000230000000001000000170104000000ffffffffffffffff28",
		data: "040000000000000003000000000000000000000000000000eeeeeeeeeeeeeeeeffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000030000000000000001010000000300000000000000230000000001000000180102000000dddddddddddddddd2805000000000501000000230000000001000000e80104000000ffffffffffffffff28",
		data: "02000000000000000200000000000000dddddddddddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000030000000000000001010000000300000000000000230000000001000000260102000000eeeeeeeeeeeeeeee0103000000ffffffffffffffff28",
		err:  ErrInvalidCode,
	},
	atTest{
		code: "0100000000030000000000000001010000000300000000000000230000000001000000100102000000eeeeeeeeeeeeeeee0103000000ffffffffffffffff28",
		err:  ErrInvalidCode,
	},
	// TODO: infinite loop, need to decrease balance correctly
	// atTest{
	// 	code: "0100000000030000000000000001010000000300000000000000230000000001000000170102000000eeeeeeeeeeeeeeee04000000000401000000230000000001000000e90103000000ffffffffffffffff28",
	// 	err: ErrZeroBalance,
	// },

	atTest{
		code: "0100000000040000000000000001010000000300000000000000210000000001000000170102000000dddddddddddddddd0500000000210000000001000000170103000000eeeeeeeeeeeeeeee0500000000210000000001000000170104000000ffffffffffffffff28",
		data: "0200000000000000030000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000040000000000000001010000000300000000000000210000000001000000180102000000dddddddddddddddd280500000000210000000001000000ed0104000000ffffffffffffffff28",
		data: "03000000000000000300000000000000dddddddddddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000030000000000000001010000000300000000000000210000000001000000260102000000eeeeeeeeeeeeeeee0103000000ffffffffffffffff28",
		err:  ErrInvalidCode,
	},
	atTest{
		code: "0100000000020000000000000001010000000100000000000000210000000001000000100102000000eeeeeeeeeeeeeeee0103000000ffffffffffffffff28",
		err:  ErrInvalidCode,
	},
	// TODO:
	// atTest{
	// 	code: "0100000000030000000000000001010000000300000000000000210000000001000000170102000000eeeeeeeeeeeeeeee0400000000210000000001000000ee0103000000ffffffffffffffff28",
	// 	err: ErrZeroBalance,
	// },

	atTest{
		code: "01000000000200000000000000010100000001000000000000001f0000000001000000170102000000eeeeeeeeeeeeeeee050000000005000000001f0000000001000000170103000000ffffffffffffffff28",
		data: "000000000000000001000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01000000000200000000000000010100000001000000000000001f0000000001000000180102000000eeeeeeeeeeeeeeee28040100000004010000001f0100000000000000e80103000000ffffffffffffffff28",
		data: "02000000000000000300000000000000eeeeeeeeeeeeeeee0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01000000000200000000000000010100000001000000000000001f0000000001000000260102000000eeeeeeeeeeeeeeee0103000000ffffffffffffffff28",
		err:  ErrInvalidCode,
	},
	atTest{
		code: "01000000000200000000000000010100000001000000000000001f0000000001000000030102000000eeeeeeeeeeeeeeee0103000000ffffffffffffffff28",
		err:  ErrInvalidCode,
	},
	// TODO:
	// atTest{
	// 	code: "01000000000200000000000000010100000001000000000000001f0000000001000000170102000000eeeeeeeeeeeeeeee040100000004010000001f0100000000000000e90103000000ffffffffffffffff28",
	// 	err: ErrZeroBalance,
	// },

	atTest{
		code: "0100000000040000000000000001010000000300000000000000220000000001000000170102000000dddddddddddddddd0500000000220000000001000000170103000000eeeeeeeeeeeeeeee0500000000220000000001000000170104000000ffffffffffffffff28",
		data: "02000000000000000300000000000000dddddddddddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000030000000000000001010000000300000000000000220000000001000000180102000000dddddddddddddddd280500000000220000000001000000ed0104000000ffffffffffffffff28",
		data: "02000000000000000300000000000000dddddddddddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000030000000000000001010000000300000000000000220000000001000000260102000000eeeeeeeeeeeeeeee0103000000ffffffffffffffff28",
		err:  ErrInvalidCode,
	},
	atTest{
		code: "0100000000020000000000000001010000000100000000000000220000000001000000100102000000eeeeeeeeeeeeeeee0103000000ffffffffffffffff28",
		data: "02000000000000000100000000000000eeeeeeeeeeeeeeeeffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	// TODO:
	// atTest{
	// 	code: "0100000000030000000000000001010000000300000000000000220000000001000000170102000000eeeeeeeeeeeeeeee0401000000220000000001000000ee0103000000ffffffffffffffff28",
	// 	err: ErrZeroBalance,
	// },

	atTest{
		code: "0100000000020000000000000001010000000300000000000000200000000001000000170102000000eeeeeeeeeeeeeeee04000000000400000000200000000001000000170103000000ffffffffffffffff28",
		data: "040000000000000003000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000020000000000000001010000000300000000000000200000000001000000180102000000eeeeeeeeeeeeeeee280501000000200100000000000000ed0501000000200100000000000000de0103000000ffffffffffffffff28",
		data: "02000000000000000100000000000000eeeeeeeeeeeeeeee0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000020000000000000001010000000300000000000000200000000001000000260102000000eeeeeeeeeeeeeeee0103000000ffffffffffffffff28",
		err:  ErrInvalidCode,
	},
	atTest{
		code: "0100000000020000000000000001010000000300000000000000200000000001000000100102000000eeeeeeeeeeeeeeee0103000000ffffffffffffffff28",
		err:  ErrInvalidCode,
	},
	// TODO:
	// atTest{
	// 	code: "0100000000020000000000000001010000000300000000000000200000000001000000170102000000eeeeeeeeeeeeeeee04010000000401000000200000000001000000e90103000000ffffffffffffffff28",
	// 	err: ErrZeroBalance,
	// },

	atTest{
		code: "0100000000020000000000000001010000000300000000000000240000000001000000170102000000dddddddddddddddd0500000000240000000001000000170103000000eeeeeeeeeeeeeeee04000000000400000000240000000001000000170104000000ffffffffffffffff28",
		data: "0300000000000000030000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000020000000000000001010000000300000000000000240000000001000000180102000000dddddddddddddddd2805000000000501000000240000000001000000e80104000000ffffffffffffffff28",
		data: "01000000000000000200000000000000dddddddddddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000040000000000000001010000000300000000000000240000000001000000260102000000eeeeeeeeeeeeeeee0103000000ffffffffffffffff28",
		err:  ErrInvalidCode,
	},
	atTest{
		code: "0100000000030000000000000001010000000500000000000000240000000001000000100102000000eeeeeeeeeeeeeeee0103000000ffffffffffffffff28",
		err:  ErrInvalidCode,
	},
	// TODO:
	// atTest{
	// 	code: "0100000000030000000000000001010000000400000000000000240000000001000000170102000000eeeeeeeeeeeeeeee04000000000401000000240000000001000000e90103000000ffffffffffffffff28",
	// 	err: ErrZeroBalance,
	// },

	atTest{
		code: "010000000001000000000000001e0000000014010100000011111111111111112805000000001e00000000130102000000ffffffffffffffff28",
		data: "00000000000000000000000000000000ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "010000000001000000000000001e00000000140101000000111111111111111128013f000000ffffffffffffffff1e3f000000e50102000000ffffffffffffffff28",
		data: "010000000000000011111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff",
	},
	atTest{
		code: "010000000001000000000000001e00000000160101000000111111111111111128013f000000ffffffffffffffff1e3f000000e50102000000ffffffffffffffff28",
		err:  ErrInvalidCode,
	},
	atTest{
		code: "010000000001000000000000001e00000000140101000000111111111111111128013f000000ffffffffffffffff1e3f000000d10102000000ffffffffffffffff28",
		err:  ErrInvalidCode,
	},
	// TODO:
	// atTest{
	// 	code: "010000000001000000000000001e000000001301010000001111111111111111013f000000ffffffffffffffff1e3f000000e60102000000ffffffffffffffff28",
	// 	err: ErrZeroBalance,
	// },

	atTest{
		code: "01000000000f0000000000000001010000000e0000000000000001020000000d0000000000000001030000000c0000000000000001040000000b0000000000000001050000000a0000000000000001060000000900000000000000010700000008000000000000000108000000070000000000000001090000000600000000000000010a0000000500000000000000010b0000000400000000000000010c0000000300000000000000010d0000000200000000000000010e00000001000000000000000a00000000010000000a01000000020000000a02000000030000000a03000000040000000a04000000050000000a05000000060000000a06000000070000000a07000000080000000a080000000a0000000a090000000a0000000a0a0000000b0000000a0b0000000c0000000a0c0000000d0000000a0d0000000e00000028",
		data: "0f000000000000000f000000000000000d000000000000000f000000000000000b000000000000000b0000000000000009000000000000000f0000000000000007000000000000000700000000000000050000000000000007000000000000000300000000000000030000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0101000000ffffffffffffffff0104000000ffffffffffffffff01070000000000000000000000010a000000ffffffffffffffff010d000000ffffffffffffffff011000000000000000000000000113000000ffffffffffffffff0116000000ffffffffffffffff01190000000000000000000000011c000000ffffffffffffffff011f000000ffffffffffffffff012200000000000000000000000125000000ffffffffffffffff0128000000ffffffffffffffff012b0000000000000000000000012e000000ffffffffffffffff0131000000ffffffffffffffff013400000000000000000000000137000000ffffffffffffffff013a000000ffffffffffffffff013d00000000000000000000000a01000000040000000a04000000070000000a070000000a0000000a0a0000000d0000000a0d000000100000000a10000000130000000a13000000160000000a16000000190000000a190000001c0000000a1c0000001f0000000a1f000000220000000a22000000250000000a25000000280000000a280000002b0000000a2b0000002e0000000a2e000000310000000a31000000340000000a34000000370000000a370000003a0000000a3a0000003d0000000a3d0000003d00000028",
		data: "0000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01010000000123456789abcdef0104000000ffffffffffffffff01070000000123456789abcdef010a0000000000000000000000010d0000000123456789abcdef0110000000ffffffffffffffff01130000000123456789abcdef0116000000000000000000000001190000000123456789abcdef011c000000ffffffffffffffff011f0000000123456789abcdef0122000000000000000000000001250000000123456789abcdef0128000000ffffffffffffffff012b0000000123456789abcdef012e000000000000000000000001310000000123456789abcdef0134000000ffffffffffffffff01370000000123456789abcdef013a0000000000000000000000013d0000000123456789abcdef0a01000000040000000a04000000070000000a070000000a0000000a0a0000000d0000000a0d000000100000000a10000000130000000a13000000160000000a16000000190000000a190000001c0000000a1c0000001f0000000a1f000000220000000a22000000250000000a25000000280000000a280000002b0000000a2b0000002e0000000a2e000000310000000a31000000340000000a34000000370000000a370000003a0000000a3a0000003d0000000a3d0000003d00000028",
		data: "0000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef00000000000000000000000000000000",
	},
	atTest{
		code: "01000000009999999999999999010100000044444444444444440102000000ffffffffdddddddd01100000008888888888888888011100000055555555555555550112000000ffffffffdddddddd01200000007777777777777777012100000088888888888888880122000000ffffffffdddddddd01300000006666666666666666013100000099999999999999990132000000ffffffffdddddddd0a00000000010000000a00000000010000000a10000000110000000a10000000110000000a10000000110000000a20000000210000000a20000000210000000a20000000210000000a20000000210000000a30000000310000000a30000000310000000a30000000310000000a30000000310000000a300000003100000028",
		data: "dddddddddddddddd4444444444444444ffffffffdddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000dddddddddddddddd5555555555555555ffffffffdddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff8888888888888888ffffffffdddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff9999999999999999ffffffffdddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "013e000000ffffffff00000000013f000000ffffffffffffffff0a3e0000003f0000000a3f0000004000000028",
		data: "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffff",
		err:  ErrOverflow,
	},
	atTest{
		code: "0affffffffffffffff28",
		err:  ErrOverflow,
	},

	atTest{
		code: "010000000000000000000000001b0000000014010000000011111111111111112804000000001b00000000ed28",
		data: "0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "010000000000000000000000001b00000000140100000000111111111111111128040000000005000000001b00000000e828",
		data: "1111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "010000000000000000000000001b00000000140100000000111111111111111128043f000000053f0000001b3f0000002028",
		err:  ErrInvalidCode,
	},
	atTest{
		code: "010000000000000000000000001b00000000140100000000111111111111111128043f000000053f0000001b3f000000f928",
		err:  ErrInvalidCode,
	},
	// atTest{
	// 	code: "010000000000000000000000001b00000000140100000000111111111111111128041f000000051f0000001b1f000000f628",
	// 	err: ErrZeroBalance,
	// }

	atTest{
		code: "01000000000000000000000000010300000003000000000000000106000000060000000000000001090000000900000000000000010c0000000c00000000000000010f0000000f00000000000000011200000012000000000000000115000000150000000000000001180000001800000000000000011b0000001b00000000000000011e0000001e00000000000000012100000021000000000000000124000000240000000000000001270000002700000000000000012a0000002a00000000000000012d0000002d0000000000000001300000003000000000000000013300000033000000000000000136000000360000000000000001390000003900000000000000013c0000003c00000000000000013f0000003f000000000000000300000000030300000003060000000309000000030c000000030f000000031200000003150000000318000000031b000000031e000000032100000003240000000327000000032a000000032d0000000330000000033300000003360000000339000000033c000000033f00000028",
		data: "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0101000000ffffffffffffffff0104000000ffffffffffffffff0107000000ffffffffffffffff010a000000ffffffffffffffff010d000000ffffffffffffffff0110000000ffffffffffffffff0113000000ffffffffffffffff0116000000ffffffffffffffff0119000000ffffffffffffffff011c000000ffffffffffffffff011f000000ffffffffffffffff0122000000ffffffffffffffff0125000000ffffffffffffffff0128000000ffffffffffffffff012b000000ffffffffffffffff012e000000ffffffffffffffff0131000000ffffffffffffffff0134000000ffffffffffffffff0137000000ffffffffffffffff013a000000ffffffffffffffff013d000000ffffffffffffffff030100000003040000000307000000030a000000030d0000000310000000031300000003160000000319000000031c000000031f000000032200000003250000000328000000032b000000032e000000033100000003340000000337000000033a000000033d00000028",
		data: "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01020000000123456789abcdef01050000000123456789abcdef01080000000123456789abcdef010b0000000123456789abcdef010e0000000123456789abcdef01110000000123456789abcdef01140000000123456789abcdef01170000000123456789abcdef011a0000000123456789abcdef011d0000000123456789abcdef01200000000123456789abcdef01230000000123456789abcdef01260000000123456789abcdef01290000000123456789abcdef012c0000000123456789abcdef012f0000000123456789abcdef01320000000123456789abcdef01350000000123456789abcdef01380000000123456789abcdef013b0000000123456789abcdef013e0000000123456789abcdef030200000003050000000308000000030b000000030e000000031100000003140000000317000000031a000000031d0000000320000000032300000003260000000329000000032c000000032f000000033200000003350000000338000000033b000000033e00000028",
		data: "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "010200000000000000000000000103000000ffffffffffffffff01040000001111111111111111011100000055555555555555550114000000888888888888888801170000004444444444444444012200000022222222222222220123000000777777777777777701240000003333333333333333030300000003030000000303000000031100000003110000000317000000031700000003230000000323000000032300000028",
		data: "0000000000000000000000000000000000000000000000000000000000000000111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000088888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000222222222222222200000000000000003333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "013e000000ffffffffffffffff013f000000ffffffffffffffff033f000000034000000028",
		err:  ErrOverflow,
	},
	atTest{
		code: "03ffffffff28",
		err:  ErrOverflow,
	},

	atTest{
		code: "01000000000000000000000000010100000001000000000000000102000000020000000000000001030000000300000000000000010400000004000000000000000105000000050000000000000001060000000600000000000000010700000007000000000000000108000000080000000000000001090000000900000000000000010a0000000a00000000000000010b0000000b00000000000000010c0000000c00000000000000010d0000000d00000000000000010e0000000e00000000000000010f0000000f000000000000000110000000100000000000000001110000001100000000000000011200000012000000000000000113000000130000000000000001140000001400000000000000011500000015000000000000000500000000050100000005020000000503000000050400000005050000000506000000050700000005080000000509000000050a000000050b000000050c000000050d000000050e000000050f00000005100000000511000000051200000005130000000514000000051500000028",
		data: "ffffffffffffffff00000000000000000100000000000000020000000000000003000000000000000400000000000000050000000000000006000000000000000700000000000000080000000000000009000000000000000a000000000000000b000000000000000c000000000000000d000000000000000e000000000000000f0000000000000010000000000000001100000000000000120000000000000013000000000000001400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01010000000e000000000000000104000000000000000000000001070000000e00000000000000010a0000000000000000000000010d0000000e000000000000000110000000000000000000000001130000000e000000000000000116000000000000000000000001190000000e00000000000000011c0000000000000000000000011f0000000e000000000000000122000000000000000000000001250000000e0000000000000001280000000000000000000000012b0000000e00000000000000012e000000000000000000000001310000000e000000000000000134000000000000000000000001370000000e00000000000000013a0000000000000000000000013d0000000e00000000000000050100000005040000000507000000050a000000050d0000000510000000051300000005160000000519000000051c000000051f000000052200000005250000000528000000052b000000052e000000053100000005340000000537000000053a000000053d00000028",
		data: "00000000000000000d0000000000000000000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000d0000000000000000000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000d0000000000000000000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000d0000000000000000000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000d0000000000000000000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000d0000000000000000000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000d0000000000000000000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000d0000000000000000000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000d0000000000000000000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000d0000000000000000000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000d0000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01010000000123456789abcdef01040000000123456789abcdef01070000000123456789abcdef010a0000000123456789abcdef010d0000000123456789abcdef01100000000123456789abcdef01130000000123456789abcdef01160000000123456789abcdef01190000000123456789abcdef011c0000000123456789abcdef011f0000000123456789abcdef01220000000123456789abcdef01250000000123456789abcdef01280000000123456789abcdef012b0000000123456789abcdef012e0000000123456789abcdef01310000000123456789abcdef01340000000123456789abcdef01370000000123456789abcdef013a0000000123456789abcdef013d0000000123456789abcdef050100000005040000000507000000050a000000050d0000000510000000051300000005160000000519000000051c000000051f000000052200000005250000000528000000052b000000052e000000053100000005340000000537000000053a000000053d00000028",
		data: "00000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef000000000000000000000000000000000023456789abcdef00000000000000000000000000000000",
	},
	atTest{
		code: "0100000000ffffffffffffffff010100000002000000000000000102000000ffffffffffffffff0110000000ffffffffffffffff011100000003000000000000000112000000ffffffffffffffff0120000000ffffffffffffffff012100000004000000000000000122000000ffffffffffffffff0130000000ffffffffffffffff013100000005000000000000000132000000ffffffffffffffff0501000000050100000005110000000511000000051100000005210000000521000000052100000005210000000531000000053100000005310000000531000000053100000028",
		data: "ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "013d000000feffffffffffffff013e0000000000000000000000013f000000feffffffffffffff053d000000053e000000053f000000054000000028",
		data: "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fdfffffffffffffffffffffffffffffffdffffffffffffff",
		err:  ErrOverflow,
	},
	atTest{
		code: "05ffffffff28",
		err:  ErrOverflow,
	},

	atTest{
		code: "01000000000f0000000000000001010000000e0000000000000001020000000d0000000000000001030000000c0000000000000001040000000b0000000000000001050000000a0000000000000001060000000900000000000000010700000008000000000000000108000000070000000000000001090000000600000000000000010a0000000500000000000000010b0000000400000000000000010c0000000300000000000000010d0000000200000000000000010e000000010000000000000009000000000100000009010000000200000009020000000300000009030000000400000009040000000500000009050000000600000009060000000700000009070000000800000009080000000900000009090000000a000000090a0000000b000000090b0000000c000000090c0000000d000000090d0000000e00000028",
		data: "0100000000000000010000000000000001000000000000000100000000000000010000000000000001000000000000000100000000000000010000000000000001000000000000000100000000000000010000000000000001000000000000000100000000000000020000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0101000000ffffffffffffffff0104000000ffffffffffffffff01070000000000000001000000010a000000ffffffffffffffff010d000000ffffffffffffffff011000000000000000010000000113000000ffffffffffffffff0116000000ffffffffffffffff01190000000000000001000000011c000000ffffffffffffffff011f000000ffffffffffffffff012200000000000000010000000125000000ffffffffffffffff0128000000ffffffffffffffff012b0000000000000001000000012e000000ffffffffffffffff0131000000ffffffffffffffff013400000000000000010000000137000000ffffffffffffffff013a000000ffffffffffffffff013d000000000000000100000009010000000400000009040000000700000009070000000a000000090a0000000d000000090d0000001000000009100000001300000009130000001600000009160000001900000009190000001c000000091c0000001f000000091f0000002200000009220000002500000009250000002800000009280000002b000000092b0000002e000000092e0000003100000009310000003400000009340000003700000009370000003a000000093a0000003d000000093d0000003d00000028",
		data: "000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff0000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff0000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff0000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff0000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff0000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01010000000123456789abcdef0104000000000000000100000001070000000123456789abcdef010a0000000000000001000000010d0000000123456789abcdef0110000000000000000100000001130000000123456789abcdef0116000000000000000100000001190000000123456789abcdef011c0000000000000001000000011f0000000123456789abcdef0122000000000000000100000001250000000123456789abcdef01280000000000000001000000012b0000000123456789abcdef012e000000000000000100000001310000000123456789abcdef0134000000000000000100000001370000000123456789abcdef013a0000000000000001000000013d0000000123456789abcdef09010000000400000009040000000700000009070000000a000000090a0000000d000000090d0000001000000009100000001300000009130000001600000009160000001900000009190000001c000000091c0000001f000000091f0000002200000009220000002500000009250000002800000009280000002b000000092b0000002e000000092e0000003100000009310000003400000009340000003700000009370000003a000000093a0000003d000000093d0000003d00000028",
		data: "00000000000000008aabcdefffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000008aabcdefffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000008aabcdefffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000008aabcdefffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000008aabcdefffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000008aabcdefffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000008aabcdefffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000008aabcdefffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000008aabcdefffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000008aabcdefffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01000000000000000099999999010100000000000100000000000102000000999999990000000001100000000000000099999999011100000000100000000000000112000000999999090000000001200000000000000099999999012100000000010000000000000122000000999999990000000001300000000000000099999999013100000010000000000000000132000000009099999909000009000000000100000009000000000100000009100000001100000009100000001100000009100000001100000009200000002100000009200000002100000009200000002100000009200000002100000009300000003100000009300000003100000009300000003100000009300000003100000009300000003100000028",
		data: "99999999ffffffff0000010000000000999999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009a9999f9ffffffff00100000000000009999990900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000099999999ffffffff0001000000000000999999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000090999999f9ffff100000000000000000909999990900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "013e000000ffffffffffffffff013f000000ffffffffffffffff093e0000003f000000093f0000004000000028",
		data: "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000ffffffffffffffff",
		err:  ErrOverflow,
	},
	atTest{
		code: "013e0000001111111111111111013f0000000000000000000000093e0000003f00000028",
		err:  ErrInvalidCode,
	},
	atTest{
		code: "09ffffffffffffffff28",
		err:  ErrOverflow,
	},

	atTest{
		code: "32020032010028",
	},
	atTest{
		code: "32030028",
	},
	atTest{
		code: "32040028",
	},

	atTest{
		code: "0101000000ff000000000000003301000100000028",
	},
	atTest{
		code: "0101000000ff000000000000003302000100000028",
	},
	atTest{
		code: "0101000000ff000000000000003303000100000028",
	},

	atTest{
		code: "0100000000040000000000000001010000000300000000000000340200000000000100000028",
	},
	atTest{
		code: "0100000000060000000000000001010000000300000000000000340300000000000100000028",
	},
	atTest{
		code: "0100000000060000000000000001010000000300000000000000340400000000000100000028",
	},

	atTest{
		code: "3504000400000035030003000000350200020000003501000100000028",
		data: "0000000000000000010000000000000001000000000000000a00000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "010000000000000000000000000101000000ffffffffffffffff3502000100000004000000001e01000000f428",
		data: "0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},

	atTest{
		code: "01010000000f00000000000000360200000000000100000001030000000800000000000000360300020000000300000028",
		data: "1e000000000000000f0000000000000004000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	// atTest{
	// 	code: "010100000001000000000000000102000000ffffffffffffff0f36020001000000010000000400000000200100000002000000f028",
	// 	data: "21000000000000000000000002000000ffffffffffffff0f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	// 	err: ErrZeroBalance
	// },

	atTest{
		code: "010000000004000000000000000101000000030000000000000037020002000000000000000100000037030003000000000000000100000037040004000000000000000100000028",
		data: "040000000000000003000000000000000c000000000000000100000000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	// atTest{
	// 	code: "01000000000400000000000000010100000003000000000000000102000000ffffffffffffff0f3704000100000000000000010000000403000000200100000002000000ec28",
	// 	data: "04000000000000008700000000000000ffffffffffffff0f2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	// 	err: ErrZeroBalance,
	// },

	atTest{
		code: "0100000000111111110000000030280100000000000000002222222228",
		data: "1111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "280100000000111111110000000028",
		data: "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},

	atTest{
		code: "0100000000111111110000000026000000000100000000000000000000000026000000000100000000111111110000000028",
		data: "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01000000001111111100000000261111111128",
		err:  ErrOverflow,
	},

	atTest{
		code: "01000000000000000000000000010100000001000000000000000102000000020000000000000001030000000300000000000000010400000004000000000000000105000000050000000000000001060000000600000000000000010700000007000000000000000108000000080000000000000001090000000900000000000000010a0000000a00000000000000010b0000000b00000000000000010c0000000c00000000000000010d0000000d00000000000000010e0000000e00000000000000010f0000000f000000000000000110000000100000000000000001110000001100000000000000011200000012000000000000000113000000130000000000000001140000001400000000000000011500000015000000000000000400000000040100000004020000000403000000040400000004050000000406000000040700000004080000000409000000040a000000040b000000040c000000040d000000040e000000040f00000004100000000411000000041200000004130000000414000000041500000028",
		data: "0100000000000000020000000000000003000000000000000400000000000000050000000000000006000000000000000700000000000000080000000000000009000000000000000a000000000000000b000000000000000c000000000000000d000000000000000e000000000000000f000000000000001000000000000000110000000000000012000000000000001300000000000000140000000000000015000000000000001600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0101000000feffffffffffffff0104000000ffffffffffffffff0107000000feffffffffffffff010a000000ffffffffffffffff010d000000feffffffffffffff0110000000ffffffffffffffff0113000000feffffffffffffff0116000000ffffffffffffffff0119000000feffffffffffffff011c000000ffffffffffffffff011f000000feffffffffffffff0122000000ffffffffffffffff0125000000feffffffffffffff0128000000ffffffffffffffff012b000000feffffffffffffff012e000000ffffffffffffffff0131000000feffffffffffffff0134000000ffffffffffffffff0137000000feffffffffffffff013a000000ffffffffffffffff013d000000feffffffffffffff040100000004040000000407000000040a000000040d0000000410000000041300000004160000000419000000041c000000041f000000042200000004250000000428000000042b000000042e000000043100000004340000000437000000043a000000043d00000028",
		data: "0000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000",
	},
	atTest{
		code: "01010000000123456789abcdef01040000000123456789abcdef01070000000123456789abcdef010a0000000123456789abcdef010d0000000123456789abcdef01100000000123456789abcdef01130000000123456789abcdef01160000000123456789abcdef01190000000123456789abcdef011c0000000123456789abcdef011f0000000123456789abcdef01220000000123456789abcdef01250000000123456789abcdef01280000000123456789abcdef012b0000000123456789abcdef012e0000000123456789abcdef01310000000123456789abcdef01340000000123456789abcdef01370000000123456789abcdef013a0000000123456789abcdef013d0000000123456789abcdef040100000004040000000407000000040a000000040d0000000410000000041300000004160000000419000000041c000000041f000000042200000004250000000428000000042b000000042e000000043100000004340000000437000000043a000000043d00000028",
		data: "00000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef000000000000000000000000000000000223456789abcdef00000000000000000000000000000000",
	},
	atTest{
		code: "0100000000ffffffffffffffff010100000097999999999999990102000000ffffffffffffffff0110000000ffffffffffffffff011100000096999999999999990112000000ffffffffffffffff0120000000ffffffffffffffff012100000095999999999999990122000000ffffffffffffffff0130000000ffffffffffffffff013100000094999999999999990132000000ffffffffffffffff0401000000040100000004110000000411000000041100000004210000000421000000042100000004210000000431000000043100000004310000000431000000043100000028",
		data: "ffffffffffffffff9999999999999999ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff9999999999999999ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff9999999999999999ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff9999999999999999ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "013d000000feffffffffffffff013e000000ffffffffffffffff013f000000feffffffffffffff043d000000043e000000043f000000044000000028",
		data: "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff0000000000000000ffffffffffffffff",
		err:  ErrOverflow,
	},
	atTest{
		code: "04ffffffff28",
		err:  ErrOverflow,
	},

	atTest{
		code: "1a06000000280100000000222222220000000028",
		data: "2222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "1a16000000280100000000222222220000000028",
		err:  ErrInvalidCode,
	},
	atTest{
		code: "1a11111111280100000000222222220000000028",
		err:  ErrOverflow,
	},

	atTest{
		code: "01000000000000000000000000121f00000001000000001111111111111111040000000028",
		data: "0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000000000000000000012180000000400000000280100000000101111111111111113",
		data: "1111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000000000000000000012220000000400000000280100000000101111111111111113",
		err:  ErrOverflow,
	},
	atTest{
		code: "010000000000000000000000000400000000120000000028",
		err:  ErrOverflow,
	},

	atTest{
		code: "01000000000f0000000000000001010000000e0000000000000001020000000d0000000000000001030000000c0000000000000001040000000b0000000000000001050000000a0000000000000001060000000900000000000000010700000008000000000000000108000000070000000000000001090000000600000000000000010a0000000500000000000000010b0000000400000000000000010c0000000300000000000000010d0000000200000000000000010e0000000100000000000000010f000000000000000000000008000000000100000008010000000200000008020000000300000008030000000400000008040000000500000008050000000600000008060000000700000008070000000800000008080000000900000008090000000a000000080a0000000b000000080b0000000c000000080c0000000d000000080d0000000e000000080e0000000f00000028",
		data: "d200000000000000b6000000000000009c0000000000000084000000000000006e000000000000005a00000000000000480000000000000038000000000000002a000000000000001e0000000000000014000000000000000c000000000000000600000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0101000000ffffffffffffffff0104000000ffffffffffffffff01070000000000000000000000010a000000ffffffffffffffff010d000000ffffffffffffffff011000000000000000000000000113000000ffffffffffffffff0116000000ffffffffffffffff01190000000000000000000000011c000000ffffffffffffffff011f000000ffffffffffffffff012200000000000000000000000125000000ffffffffffffffff0128000000ffffffffffffffff012b0000000000000000000000012e000000ffffffffffffffff0131000000ffffffffffffffff013400000000000000000000000137000000ffffffffffffffff013a000000ffffffffffffffff013d000000000000000000000008010000000400000008040000000700000008070000000a000000080a0000000d000000080d0000001000000008100000001300000008130000001600000008160000001900000008190000001c000000081c0000001f000000081f0000002200000008220000002500000008250000002800000008280000002b000000082b0000002e000000082e0000003100000008310000003400000008340000003700000008370000003a000000083a0000003d000000083d0000003d00000028",
		data: "0000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01010000000123456789abcdef0104000000111111111111111101070000000123456789abcdef010a0000001111111111111111010d0000000123456789abcdef0110000000111111111111111101130000000123456789abcdef0116000000111111111111111101190000000123456789abcdef011c0000001111111111111111011f0000000123456789abcdef0122000000111111111111111101250000000123456789abcdef01280000001111111111111111012b0000000123456789abcdef012e000000111111111111111101310000000123456789abcdef0134000000111111111111111101370000000123456789abcdef013a0000001111111111111111013d0000000123456789abcdef08010000000400000008040000000700000008070000000a000000080a0000000d000000080d0000001000000008100000001300000008130000001600000008160000001900000008190000001c000000081c0000001f000000081f0000002200000008220000002500000008250000002800000008280000002b000000082b0000002e000000082e0000003100000008310000003400000008340000003700000008370000003a000000083a0000003d000000083d0000003d00000028",
		data: "00000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f0000000000000000000000000000000001164fbd6f65a03f000000000000000000000000000000000014653b1e88105fc00000000000000000000000000000000",
	},
	atTest{
		code: "01000000009999999900000000010100000000000100000000000102000000000000009999999901100000009999999900000000011100000000100000000000000112000000000000009099999901200000009999999900000000012100000000010000000000000122000000000000009999999901300000000090999999090000013100000010000000000000000132000000000000009999999908000000000100000008000000000100000008100000001100000008100000001100000008100000001100000008200000002100000008200000002100000008200000002100000008200000002100000008300000003100000008300000003100000008300000003100000008300000003100000008300000003100000028",
		data: "0000000099999999000001000000000000000000999999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009099999900100000000000000000000090999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000999999990001000000000000000000009999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000099999999100000000000000000000000999999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "013e0000001111111111111111013f000000ffffffffffffffff083e0000003f000000083f0000004000000028",
		data: "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000efeeeeeeeeeeeeeeffffffffffffffff",
		err:  ErrOverflow,
	},
	atTest{
		code: "08ffffffffffffffff28",
		err:  ErrOverflow,
	},
	atTest{
		code: "01000000000f0000000000000001010000000e0000000000000001020000000d0000000000000001030000000c0000000000000001040000000b0000000000000001050000000a0000000000000001060000000900000000000000010700000008000000000000000108000000070000000000000001090000000600000000000000010a0000000500000000000000010b0000000400000000000000010c0000000300000000000000010d0000000200000000000000010e00000001000000000000000d000000000d010000000d020000000d030000000d040000000d050000000d060000000d070000000d080000000d090000000d0a0000000d0b0000000d0c0000000d0d00000028",
		data: "f0fffffffffffffff1fffffffffffffff2fffffffffffffff3fffffffffffffff4fffffffffffffff5fffffffffffffff6fffffffffffffff7fffffffffffffff8fffffffffffffff9fffffffffffffffafffffffffffffffbfffffffffffffffcfffffffffffffffdffffffffffffff01000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0101000000ffffffffffffffff0104000000ffffffff0000000001070000000000000000000000010a000000ffffffffffffffff010d000000ffffffff00000000011000000000000000000000000113000000ffffffffffffffff0116000000ffffffff0000000001190000000000000000000000011c000000ffffffffffffffff011f000000ffffffff00000000012200000000000000000000000125000000ffffffffffffffff0128000000ffffffff00000000012b0000000000000000000000012e000000ffffffffffffffff0131000000ffffffff00000000013400000000000000000000000137000000ffffffffffffffff013a000000ffffffff00000000013d00000000000000000000000d010000000d040000000d070000000d0a0000000d0d0000000d100000000d130000000d160000000d190000000d1c0000000d1f0000000d220000000d250000000d280000000d2b0000000d2e0000000d310000000d340000000d370000000d3a0000000d3d00000028",
		data: "000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000000000000000000000000000ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000000000000000000000000000ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000000000000000000000000000ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000000000000000000000000000ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000000000000000000000000000ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000000000000000000000000000ffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000",
	},
	atTest{
		code: "01010000000123456789abcdef0104000000ffffffffffffffff01070000000123456789abcdef010a000000ffffffff00000000010d0000000123456789abcdef0110000000000000000000000001130000000123456789abcdef0116000000ffffffffffffffff01190000000123456789abcdef011c000000ffffffff00000000011f0000000123456789abcdef0122000000000000000000000001250000000123456789abcdef0128000000ffffffffffffffff012b0000000123456789abcdef012e000000ffffffff0000000001310000000123456789abcdef0134000000000000000000000001370000000123456789abcdef013a000000ffffffffffffffff013d0000000123456789abcdef0d010000000d040000000d070000000d0a0000000d0d0000000d100000000d130000000d160000000d190000000d1c0000000d1f0000000d220000000d250000000d280000000d2b0000000d2e0000000d310000000d340000000d370000000d3a0000000d3d00000028",
		data: "0000000000000000fedcba987654321000000000000000000000000000000000000000000000000000000000000000000000000000000000fedcba98765432100000000000000000000000000000000000000000ffffffff00000000000000000000000000000000fedcba987654321000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000fedcba987654321000000000000000000000000000000000000000000000000000000000000000000000000000000000fedcba98765432100000000000000000000000000000000000000000ffffffff00000000000000000000000000000000fedcba987654321000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000fedcba987654321000000000000000000000000000000000000000000000000000000000000000000000000000000000fedcba98765432100000000000000000000000000000000000000000ffffffff00000000000000000000000000000000fedcba987654321000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000fedcba987654321000000000000000000000000000000000000000000000000000000000000000000000000000000000fedcba987654321000000000000000000000000000000000",
	},
	atTest{
		code: "01000000009999999999999999010100000011111111111111110102000000ffffffff9999999901100000008888888888888888011100000022222222222222220112000000ffffffff7777777701200000006666666666666666012100000033333333333333330122000000ffffffff6666666601300000005555555555555555013100000044444444444444440132000000ffffffffaaaaaaaa0d000000000d000000000d100000000d100000000d100000000d200000000d200000000d200000000d200000000d300000000d300000000d300000000d300000000d300000002801000000009999999999999999010100000011111111111111110102000000ffffffff9999999901100000008888888888888888011100000022222222222222220112000000ffffffff7777777701200000006666666666666666012100000033333333333333330122000000ffffffff6666666601300000005555555555555555013100000044444444444444440132000000ffffffffaaaaaaaa0d000000000d000000000d100000000d100000000d100000000d200000000d200000000d200000000d200000000d300000000d300000000d300000000d300000000d3000000028",
		data: "99999999999999991111111111111111ffffffff99999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000077777777777777772222222222222222ffffffff77777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066666666666666663333333333333333ffffffff666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000aaaaaaaaaaaaaaaa4444444444444444ffffffffaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "013e000000ffffffff00000000013f000000ffffffffffffffff0d3e0000000d3f0000000d4000000028",
		data: "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff0000000000000000",
		err:  ErrOverflow,
	},
	atTest{
		code: "0dffffffff28",
		err:  ErrOverflow,
	},

	atTest{
		code: "0100000000000000001111111110000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000110100000011020000001103000000110400000011050000001106000000110700000011080000001109000000110a00000028",
		data: "0000000011111111000000001111111100000000111111110000000011111111000000001111111100000000111111110000000011111111000000001111111100000000111111110000000011111111000000001111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "010000000000000000111111111000000000010800000000000000111111121008000000011800000000000000111111131018000000012800000000000000111111141028000000013800000000000000111111151038000000013a0000000000000011111116103a000000013c0000000000000011111117103c000000013e0000000000000011111118103e00000011010000001109000000111900000011290000001139000000113d000000113f00000028",
		data: "0000000011111111000000001111111800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111120000000011111117000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111113000000001111111600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111400000000111111150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111150000000011111114000000001111111600000000000000000000000011111117000000001111111300000000111111180000000011111112",
	},
	atTest{
		code: "111000000028",
		err:  ErrOverflow,
	},
	atTest{
		code: "010000000011111111000000001000000000114000000028",
		err:  ErrOverflow,
	},

	atTest{
		code: "0100000000000000001111111110000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000028",
		data: "0000000011111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "010000000000000000111111111000000000010800000000000000111111121008000000011800000000000000111111131018000000012800000000000000111111141028000000013800000000000000111111151038000000013a0000000000000011111116103a000000013c0000000000000011111117103c000000013e0000000000000011111118103e0000000101000000000000001111111910010000000109000000000000001111111a10090000000119000000000000001111111b10190000000129000000000000001111111c10290000000139000000000000001111111d1039000000013d000000000000001111111e103d000000013e000000000000001111111f103e00000028",
		data: "000000001111111100000000111111190000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111112000000001111111a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111113000000001111111b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111114000000001111111c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111115000000001111111d000000001111111600000000000000000000000011111117000000001111111e000000001111111f0000000000000000",
	},
	atTest{
		code: "104000000028",
		err:  ErrOverflow,
	},
	atTest{
		code: "0100000000000000001111111110000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000010000000001000000000100000000028",
		err:  ErrOverflow,
	},

	atTest{
		code: "0100000000000000000000000012200000000100000000111111111111111128040000000013",
		data: "1111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01000000000000000000000000121800000004000000002801000000001011111111111111122b000000130110000000111111110000000013",
		data: "1111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000000000000000000012190000000400000000132801000000001011111111111111122c000000130110000000111111110000000013",
		err:  ErrOverflow,
	},
	atTest{
		code: "0100000000000000000000000004000000001328",
		err:  ErrOverflow,
	},

	atTest{
		code: "01000000001111111111111111020100000000000000020300000000000000020500000000000000020700000000000000020900000000000000020b00000000000000020d00000000000000020f00000000000000021100000000000000021300000000000000021500000000000000021700000000000000021900000000000000021b00000000000000021d00000000000000021f00000000000000022100000000000000022300000000000000022500000000000000022700000000000000022900000000000000022b00000000000000022d00000000000000022f00000000000000023100000000000000023300000000000000023500000000000000023700000000000000023900000000000000023b00000000000000023d00000000000000023f0000000000000028",
		data: "1111111111111111111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111",
	},
	atTest{
		code: "0100000000ffffffffffffffff020200000000000000020400000002000000020600000004000000020800000006000000020a00000008000000020c0000000a000000020e0000000c00000002100000000e000000021200000010000000021400000012000000021600000014000000021800000016000000021a00000018000000021c0000001a000000021e0000001c00000002200000001e000000022200000020000000022400000022000000022600000024000000022800000026000000022a00000028000000022c0000002a000000022e0000002c00000002300000002e000000023200000030000000023400000032000000023600000034000000023800000036000000023a00000038000000023c0000003a000000023e0000003c00000028",
		data: "ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000ffffffffffffffff0000000000000000",
	},
	atTest{
		code: "0100000000ffffffffffffffff02400000000000000028",
		err:  ErrOverflow,
	},
	atTest{
		code: "0100000000ffffffffffffffff02020000004000000028",
		err:  ErrOverflow,
	},
	atTest{
		code: "0100000000ffffffffffffffff02ffffffff0000000028",
		err:  ErrOverflow,
	},
	atTest{
		code: "0100000000ffffffffffffffff020200000ffffffff028",
		err:  ErrOverflow,
	},

	atTest{
		code: "0100000000000000000000000001010000001111111100000000010200000001000000000000000f0300000000000000020000000104000000040000000000000001050000001111111100000000010600000001000000000000000f0700000004000000060000000108000000080000000000000001090000001111111100000000010a00000001000000000000000f0b000000080000000a000000010c0000000c00000000000000010d0000001111111100000000010e00000001000000000000000f0f0000000c0000000e0000000110000000100000000000000001110000001111111100000000011200000001000000000000000f1300000010000000120000000114000000140000000000000001150000001111111100000000011600000001000000000000000f1700000014000000160000000118000000180000000000000001190000001111111100000000011a00000001000000000000000f1b000000180000001a00000028",
		data: "0000000000000000111111110000000001000000000000001111111100000000040000000000000011111111000000000100000000000000111111110000000008000000000000001111111100000000010000000000000011111111000000000c00000000000000111111110000000001000000000000001111111100000000100000000000000011111111000000000100000000000000111111110000000014000000000000001111111100000000010000000000000011111111000000001800000000000000111111110000000001000000000000001111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "011c0000001c00000000000000011d0000001111111100000000011e00000001000000000000000f1f0000001c0000001e0000000120000000200000000000000001210000001111111100000000012200000001000000000000000f2300000020000000220000000124000000240000000000000001250000001111111100000000012600000001000000000000000f2700000024000000260000000128000000280000000000000001290000001111111100000000012a00000001000000000000000f2b000000280000002a000000012c0000002c00000000000000012d0000001111111100000000012e00000001000000000000000f2f0000002c0000002e0000000130000000300000000000000001310000001111111100000000013200000001000000000000000f3300000030000000320000000134000000340000000000000001350000001111111100000000013600000001000000000000000f3700000034000000360000000138000000380000000000000001390000001111111100000000013a00000001000000000000000f3b0000003a0000003800000028",
		data: "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000001111111100000000010000000000000011111111000000002000000000000000111111110000000001000000000000001111111100000000240000000000000011111111000000000100000000000000111111110000000028000000000000001111111100000000010000000000000011111111000000002c000000000000001111111100000000010000000000000011111111000000003000000000000000111111110000000001000000000000001111111100000000340000000000000011111111000000000100000000000000111111110000000038000000000000001111111100000000010000000000000011111111000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01000000003f00000000000000010100000001000000000000000f02000000010000000000000028",
		err:  ErrOverflow,
	},
	atTest{
		code: "01000000004000000000000000010100000001000000000000000f02000000010000000000000028",
		err:  ErrOverflow,
	},
	atTest{
		code: "01000000003a00000000000000010100000040000000000000000f02000000010000000000000028",
		err:  ErrOverflow,
	},

	atTest{
		code: "01000000002f00000000000000012f00000011111111111111110e01000000000000000e03000000000000000e05000000000000000e07000000000000000e09000000000000000e0b000000000000000e0d000000000000000e0f000000000000000e11000000000000000e13000000000000000e15000000000000000e17000000000000000e19000000000000000e1b000000000000000e1d000000000000000e1f000000000000000e21000000000000000e23000000000000000e25000000000000000e27000000000000000e29000000000000000e2b000000000000000e2d000000000000000e2f000000000000000e31000000000000000e33000000000000000e35000000000000000e37000000000000000e39000000000000000e3b000000000000000e3d000000000000000e3f0000000000000028",
		data: "2f00000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111000000000000000011111111111111110000000000000000111111111111111100000000000000001111111111111111",
	},
	atTest{
		code: "010000000022000000000000000e02000000000000000e04000000020000000e06000000040000000e08000000060000000e0a000000080000000e0c0000000a0000000e0e0000000c0000000e100000000e0000000e12000000100000000e14000000120000000e16000000140000000e18000000160000000e1a000000180000000e1c0000001a0000000e1e0000001c0000000e200000001e0000000e22000000200000000e24000000220000000e26000000240000000e28000000260000000e2a000000280000000e2c0000002a0000000e2e0000002c0000000e300000002e0000000e32000000300000000e34000000320000000e36000000340000000e38000000360000000e3a000000380000000e3c0000003a0000000e3e0000003c00000028",
		data: "2200000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000002200000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000002200000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000002200000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000002200000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000002200000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000ffffffffffffffff0e400000000000000028",
		err:  ErrOverflow,
	},
	atTest{
		code: "0100000000ffffffffffffffff0e000000004000000028",
		err:  ErrOverflow,
	},
	atTest{
		code: "0100000000ffffffffffffffff0effffffff0000000028",
		err:  ErrOverflow,
	},
	atTest{
		code: "0100000000ffffffffffffffff0e00000000ffffffff28",
		err:  ErrOverflow,
	},

	atTest{
		code: "010000000011111111000000003001000000002222222200000000303028",
		data: "2222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
		s: &stateMachine{
			pc:    0x1d,
			pcs:   0x1d,
			steps: 6,
		},
	},
	atTest{
		code: "3030303028",
		s: &stateMachine{
			pc:    4,
			pcs:   4,
			steps: 5,
		},
	},

	atTest{
		code: "01000000000000000000000000010100000001000000000000000102000000020000000000000001030000000300000000000000010400000004000000000000000105000000050000000000000001060000000600000000000000010700000007000000000000000108000000080000000000000001090000000900000000000000010a0000000a00000000000000010b0000000b00000000000000010c0000000c00000000000000010d0000000d00000000000000010e0000000e00000000000000010f0000000f0000000000000001100000001000000000000000011100000011000000000000000112000000120000000000000001130000001300000000000000011400000014000000000000000115000000150000000000000001160000001600000000000000011700000017000000000000000118000000180000000000000001190000001900000000000000011a0000001a00000000000000011b0000001b00000000000000011c0000001c00000000000000011d0000001d00000000000000011e0000001e00000000000000011f0000001f000000000000000120000000200000000000000001210000002100000000000000012200000022000000000000000123000000230000000000000001240000002400000000000000012500000025000000000000000126000000260000000000000028",
		data: "00000000000000000100000000000000020000000000000003000000000000000400000000000000050000000000000006000000000000000700000000000000080000000000000009000000000000000a000000000000000b000000000000000c000000000000000d000000000000000e000000000000000f0000000000000010000000000000001100000000000000120000000000000013000000000000001400000000000000150000000000000016000000000000001700000000000000180000000000000019000000000000001a000000000000001b000000000000001c000000000000001d000000000000001e000000000000001f0000000000000020000000000000002100000000000000220000000000000023000000000000002400000000000000250000000000000026000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000ffffffffffffffff0101000000ffffffffffffffff0104000000ffffffffffffffff0105000000ffffffffffffffff0108000000ffffffffffffffff0109000000ffffffffffffffff010c000000ffffffffffffffff010d000000ffffffffffffffff0110000000ffffffffffffffff0111000000ffffffffffffffff0114000000ffffffffffffffff0115000000ffffffffffffffff0118000000ffffffffffffffff0119000000ffffffffffffffff011c000000ffffffffffffffff011d000000ffffffffffffffff0120000000ffffffffffffffff0121000000ffffffffffffffff0124000000ffffffffffffffff0125000000ffffffffffffffff0128000000ffffffffffffffff0129000000ffffffffffffffff012c000000ffffffffffffffff012d000000ffffffffffffffff0130000000ffffffffffffffff0131000000ffffffffffffffff0134000000ffffffffffffffff0135000000ffffffffffffffff0138000000ffffffffffffffff0139000000ffffffffffffffff013c000000ffffffffffffffff013d000000ffffffffffffffff28",
		data: "ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000",
	},
	atTest{
		code: "0100000000efcdab89674523010105000000efcdab89674523010108000000efcdab8967452301010d000000efcdab89674523010110000000efcdab89674523010115000000efcdab89674523010118000000efcdab8967452301011d000000efcdab89674523010120000000efcdab89674523010125000000efcdab89674523010128000000efcdab8967452301012d000000efcdab89674523010130000000efcdab89674523010135000000efcdab89674523010138000000efcdab8967452301013d000000efcdab896745230128",
		data: "efcdab89674523010000000000000000000000000000000000000000000000000000000000000000efcdab896745230100000000000000000000000000000000efcdab89674523010000000000000000000000000000000000000000000000000000000000000000efcdab896745230100000000000000000000000000000000efcdab89674523010000000000000000000000000000000000000000000000000000000000000000efcdab896745230100000000000000000000000000000000efcdab89674523010000000000000000000000000000000000000000000000000000000000000000efcdab896745230100000000000000000000000000000000efcdab89674523010000000000000000000000000000000000000000000000000000000000000000efcdab896745230100000000000000000000000000000000efcdab89674523010000000000000000000000000000000000000000000000000000000000000000efcdab896745230100000000000000000000000000000000efcdab89674523010000000000000000000000000000000000000000000000000000000000000000efcdab896745230100000000000000000000000000000000efcdab89674523010000000000000000000000000000000000000000000000000000000000000000efcdab896745230100000000000000000000000000000000",
	},
	atTest{
		code: "010000000000000000000000000100000000ffffffffffffffff0100000000111111111111111101010000002222222222222222011000000000000000000000000110000000ffffffffffffffff0110000000333333333333333301110000004444444444444444012000000000000000000000000120000000ffffffffffffffff0120000000555555555555555501210000006666666666666666013000000000000000000000000130000000ffffffffffffffff013000000077777777777777770131000000888888888888888828",
		data: "1111111111111111222222222222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000333333333333333344444444444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000055555555555555556666666666666666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007777777777777777888888888888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "013f00000011111111111111110140000000111111111111111128",
		data: "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111111",
		err:  ErrOverflow,
	},
	atTest{
		code: "01ffffffff111111111111111128",
		err:  ErrOverflow,
	},

	atTest{
		code: "0100000000111111110000000027000000000100000000000000000000000029",
		data: "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},

	atTest{
		code: "0100000000111111110000000027000000000100000000000000000000000027000000000100000000111111110000000028",
		data: "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
		s: &stateMachine{
			pc:    0x1f,
			steps: 4,
		},
	},
	atTest{
		code: "01000000001111111100000000271111111128",
		err:  ErrOverflow,
	},

	atTest{
		code: "01000000000f0000000000000001010000000e0000000000000001020000000d0000000000000001030000000c0000000000000001040000000b0000000000000001050000000a0000000000000001060000000900000000000000010700000008000000000000000108000000070000000000000001090000000600000000000000010a0000000500000000000000010b0000000400000000000000010c0000000300000000000000010d0000000200000000000000010e0000000100000000000000010f000000000000000000000007000000000100000007010000000200000007020000000300000007030000000400000007040000000500000007050000000600000007060000000700000007070000000800000007080000000900000007090000000a000000070a0000000b000000070b0000000c000000070c0000000d000000070d0000000e000000070e0000000f00000028",
		data: "0100000000000000010000000000000001000000000000000100000000000000010000000000000001000000000000000100000000000000010000000000000001000000000000000100000000000000010000000000000001000000000000000100000000000000010000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0101000000ffffffffffffffff0104000000ffffffffffffffff01070000000000000000000000010a000000ffffffffffffffff010d000000ffffffffffffffff011000000000000000000000000113000000ffffffffffffffff0116000000ffffffffffffffff01190000000000000000000000011c000000ffffffffffffffff011f000000ffffffffffffffff012200000000000000000000000125000000ffffffffffffffff0128000000ffffffffffffffff012b0000000000000000000000012e000000ffffffffffffffff0131000000ffffffffffffffff013400000000000000000000000137000000ffffffffffffffff013a000000ffffffffffffffff013d000000000000000000000007010000000400000007040000000700000007070000000a000000070a0000000d000000070d0000001000000007100000001300000007130000001600000007160000001900000007190000001c000000071c0000001f000000071f0000002200000007220000002500000007250000002800000007280000002b000000072b0000002e000000072e0000003100000007310000003400000007340000003700000007370000003a000000073a0000003d000000073d0000003d00000028",
		data: "0000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01010000000123456789abcdef010400000000123456789abcde0107000000000123456789abcd010a0000000000123456789abc010d00000000000123456789ab0110000000000000123456789a011300000000000001234567890116000000000000001234567801190000000000000001234567011c0000000000000000123456011f000000000000000001234501220000000123456789abcdef012500000000123456789abcde0128000000000123456789abcd012b0000000000123456789abc012e00000000000123456789ab0131000000000000123456789a0134000000000000012345678901370000000000000012345678013a0000000000000001234567013d000000000000000012345607010000000400000007040000000700000007070000000a000000070a0000000d000000070d0000001000000007100000001300000007130000001600000007160000001900000007190000001c000000071c0000001f000000071f0000002200000007220000002500000007250000002800000007280000002b000000072b0000002e000000072e0000003100000007310000003400000007340000003700000007370000003a000000073a0000003d000000073d0000003d00000028",
		data: "0000000000000000011111111111111100000000000000000000000000000000001111111111111100000000000000000000000000000000000111111111111100000000000000000000000000000000000011111111111100000000000000000000000000000000000001111111111100000000000000000000000000000000000000111111111100000000000000000000000000000000000000011111111100000000000000000000000000000000000000001111111100000000000000000000000000000000000000000111111100000000000000000000000000000000000000000011111100000000000000000000000000000000ffdcba987655555500000000000000000000000000000000011111111111111100000000000000000000000000000000001111111111111100000000000000000000000000000000000111111111111100000000000000000000000000000000000011111111111100000000000000000000000000000000000001111111111100000000000000000000000000000000000000111111111100000000000000000000000000000000000000011111111100000000000000000000000000000000000000001111111100000000000000000000000000000000000000000111111100000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0100000000cccccccccccccccc01010000004444444444444444010200000044444444444444440110000000dddddddddddddddd01110000003333333333333333011200000044444444444444440120000000cccccccccccccccc012100000022222222222222220122000000444444444444444401300000009999999999999999013100000011111111111111110132000000444444444444444407000000000100000007000000000100000007100000001100000007100000001100000007100000001100000007200000002100000007200000002100000007200000002100000007200000002100000007300000003100000007300000003100000007300000003100000007300000003100000007300000003100000028",
		data: "4444444444444444444444444444444444444444444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000444444444444444433333333333333334444444444444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044444444444444442222222222222222444444444444444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004444444444444444111111111111111144444444444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "013e000000ffffffffffffffff013f000000ffffffffffffffff073e0000003f000000073f0000004000000028",
		data: "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff",
		err:  ErrOverflow,
	},
	atTest{
		code: "07ffffffffffffffff28",
		err:  ErrOverflow,
	},

	atTest{
		code: "010000000000000000000000000101000000111111110000000025010000000000000028000000280100000000111111111111111128",
		data: "0000000000000000111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
		err:  ErrInvalidCode,
	},
	atTest{
		code: "010000000000000000000000000101000000111111110000000025000000000100000028000000280100000000111111111111111128",
		data: "0000000000000000111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
		err:  ErrOverflow,
	},
	atTest{
		code: "010000000000000000000000000101000000111111110000000025000000000100000026000000280100000000111111111111111128",
		err:  ErrOverflow,
	},
	atTest{
		code: "010000000000000000000000000101000000111111110000000025000000000100000011111111280100000000111111111111111128",
		err:  ErrOverflow,
	},

	atTest{
		code: "01000000000f0000000000000001010000000e0000000000000001020000000d0000000000000001030000000c0000000000000001040000000b0000000000000001050000000a0000000000000001060000000900000000000000010700000008000000000000000108000000070000000000000001090000000600000000000000010a0000000500000000000000010b0000000400000000000000010c0000000300000000000000010d0000000200000000000000010e00000001000000000000000c00000000010000000c01000000020000000c02000000030000000c03000000040000000c04000000050000000c05000000060000000c06000000070000000c07000000080000000c08000000090000000c090000000a0000000c0a0000000b0000000c0b0000000c0000000c0c0000000d0000000c0d0000000e00000028",
		data: "01000000000000000300000000000000010000000000000007000000000000000100000000000000030000000000000001000000000000000f0000000000000001000000000000000300000000000000010000000000000007000000000000000100000000000000030000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "0101000000ffffffffffffffff0104000000ffffffffffffffff01070000000000000000000000010a000000ffffffffffffffff010d000000ffffffffffffffff011000000000000000000000000113000000ffffffffffffffff0116000000ffffffffffffffff01190000000000000000000000011c000000ffffffffffffffff011f000000ffffffffffffffff012200000000000000000000000125000000ffffffffffffffff0128000000ffffffffffffffff012b0000000000000000000000012e000000ffffffffffffffff0131000000ffffffffffffffff013400000000000000000000000137000000ffffffffffffffff013a000000ffffffffffffffff013d00000000000000000000000c01000000040000000c04000000070000000c070000000a0000000c0a0000000d0000000c0d000000100000000c10000000130000000c13000000160000000c16000000190000000c190000001c0000000c1c0000001f0000000c1f000000220000000c22000000250000000c25000000280000000c280000002b0000000c2b0000002e0000000c2e000000310000000c31000000340000000c34000000370000000c370000003a0000000c3a0000003d0000000c3d0000003d00000028",
		data: "0000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01010000000123456789abcdef0104000000ffffffffffffffff01070000000123456789abcdef010a000000ffffffff00000000010d0000000123456789abcdef0110000000000000000000000001130000000123456789abcdef0116000000ffffffffffffffff01190000000123456789abcdef011c000000ffffffff00000000011f0000000123456789abcdef0122000000000000000000000001250000000123456789abcdef0128000000ffffffffffffffff012b0000000123456789abcdef012e000000ffffffff0000000001310000000123456789abcdef0134000000000000000000000001370000000123456789abcdef013a000000ffffffffffffffff013d0000000123456789abcdef0c01000000040000000c04000000070000000c070000000a0000000c0a0000000d0000000c0d000000100000000c10000000130000000c13000000160000000c16000000190000000c190000001c0000000c1c0000001f0000000c1f000000220000000c22000000250000000c25000000280000000c280000002b0000000c2b0000002e0000000c2e000000310000000c31000000340000000c34000000370000000c370000003a0000000c3a0000003d0000000c3d0000003d00000028",
		data: "0000000000000000fedcba987654321000000000000000000000000000000000fedcba987654321000000000000000000000000000000000fedcba9889abcdef00000000000000000000000000000000fedcba9889abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef00000000000000000000000000000000fedcba987654321000000000000000000000000000000000fedcba987654321000000000000000000000000000000000fedcba9889abcdef00000000000000000000000000000000fedcba9889abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef00000000000000000000000000000000fedcba987654321000000000000000000000000000000000fedcba987654321000000000000000000000000000000000fedcba9889abcdef00000000000000000000000000000000fedcba9889abcdef000000000000000000000000000000000123456789abcdef000000000000000000000000000000000123456789abcdef00000000000000000000000000000000fedcba987654321000000000000000000000000000000000fedcba987654321000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "01000000009999999999999999010100000088888888888888880102000000ffffffff9999999901100000007777777777777777011100000055555555555555550112000000ffffffff2222222201200000006666666666666666012100000044444444444444440122000000ffffffff6666666601300000003333333333333333013100000011111111111111110132000000ffffffff222222220c00000000010000000c00000000010000000c10000000110000000c10000000110000000c10000000110000000c20000000210000000c20000000210000000c20000000210000000c20000000210000000c30000000310000000c30000000310000000c30000000310000000c30000000310000000c300000003100000028",
		data: "99999999999999998888888888888888ffffffff99999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000022222222222222225555555555555555ffffffff22222222000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066666666666666664444444444444444ffffffff66666666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000022222222222222221111111111111111ffffffff222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	},
	atTest{
		code: "013e000000ffffffff00000000013f000000ffffffffffffffff0c3e0000003f0000000c3f0000004000000028",
		data: "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff",
		err:  ErrOverflow,
	},
	atTest{
		code: "0cffffffffffffffff28",
		err:  ErrOverflow,
	},
}

func TestAts(t *testing.T) {
	for _, atTest := range atTests {
		code, _ := hex.DecodeString(atTest.code)
		s := newStateMachine(code)

		if assert.Equal(t, atTest.err, s.execute()) {
			if atTest.data != "" {
				assert.Equal(t, atTest.data, hex.EncodeToString(s.getData()))
			}

			if atTest.s != nil {
				assert.Equal(t, atTest.s.pc, s.pc)
				assert.Equal(t, atTest.s.pcs, s.pcs)
				assert.Equal(t, atTest.s.steps, s.steps)
				assert.Equal(t, atTest.s.cs, s.cs)
				assert.Equal(t, atTest.s.us, s.us)
			}
		}
	}
}

func TestABFuns(t *testing.T) {
	type expected struct {
		asHex string
		bsHex string
		rc    int64
	}

	type abTest struct {
		asHex string
		bsHex string

		addAToB            *expected
		addBToA            *expected
		subAFromB          *expected
		subBFromA          *expected
		mulAByB            *expected
		mulBByA            *expected
		divAByB            *expected
		divBByA            *expected
		MD5AtoB            *expected
		CheckMD5AWithB     *expected
		Hash160AToB        *expected
		CheckHash160AWithB *expected
		SHA256AtoB         *expected
		CheckSHA256AWithB  *expected
	}

	tests := []abTest{
		abTest{
			addBToA:   &expected{},
			addAToB:   &expected{},
			subAFromB: &expected{},
			subBFromA: &expected{},
			mulAByB:   &expected{},
			mulBByA:   &expected{},
			divAByB: &expected{
				rc: -2,
			},
			divBByA: &expected{
				rc: -2,
			},
		},
		abTest{
			asHex: "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
			bsHex: "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
			addBToA: &expected{
				asHex: "FEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
				bsHex: "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
				rc:    0,
			},
			addAToB: &expected{
				asHex: "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
				bsHex: "FEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
				rc:    0,
			},
			subAFromB: &expected{
				asHex: "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
				rc:    0,
			},
			subBFromA: &expected{
				bsHex: "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
				rc:    0,
			},
			mulAByB: &expected{
				asHex: "0100000000000000000000000000000000000000000000000000000000000000",
				bsHex: "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
				rc:    0,
			},
			mulBByA: &expected{
				asHex: "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
				bsHex: "0100000000000000000000000000000000000000000000000000000000000000",
				rc:    0,
			},
			divBByA: &expected{
				asHex: "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
				bsHex: "0100000000000000000000000000000000000000000000000000000000000000",
				rc:    0,
			},
			divAByB: &expected{
				asHex: "0100000000000000000000000000000000000000000000000000000000000000",
				bsHex: "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
				rc:    0,
			},
		},
		abTest{
			asHex: "0000000000000000000000000000000000000000000000000000000000000001",
			bsHex: "0000000000000000000000000000000000000000000000000000000000000002",
			addBToA: &expected{
				asHex: "0000000000000000000000000000000000000000000000000000000000000003",
				bsHex: "0000000000000000000000000000000000000000000000000000000000000002",
				rc:    0,
			},
			addAToB: &expected{
				asHex: "0000000000000000000000000000000000000000000000000000000000000001",
				bsHex: "0000000000000000000000000000000000000000000000000000000000000003",
				rc:    0,
			},
			subAFromB: &expected{
				asHex: "0000000000000000000000000000000000000000000000000000000000000001",
				bsHex: "0000000000000000000000000000000000000000000000000000000000000001",
				rc:    0,
			},
			subBFromA: &expected{
				asHex: "00000000000000000000000000000000000000000000000000000000000000FF",
				bsHex: "0000000000000000000000000000000000000000000000000000000000000002",
				rc:    0,
			},
			mulAByB: &expected{
				asHex: "0000000000000000000000000000000000000000000000000000000000000000",
				bsHex: "0000000000000000000000000000000000000000000000000000000000000002",
				rc:    0,
			},
			mulBByA: &expected{
				asHex: "0000000000000000000000000000000000000000000000000000000000000001",
				bsHex: "0000000000000000000000000000000000000000000000000000000000000000",
				rc:    0,
			},
			divBByA: &expected{
				asHex: "0000000000000000000000000000000000000000000000000000000000000001",
				bsHex: "0200000000000000000000000000000000000000000000000000000000000000",
				rc:    0,
			},
			divAByB: &expected{
				asHex: "0000000000000000000000000000000000000000000000000000000000000000",
				bsHex: "0000000000000000000000000000000000000000000000000000000000000002",
				rc:    0,
			},
		},
		abTest{
			asHex: "9876543211234567890123985719203875618230178120381920412839412381",
			bsHex: "0000820757581283748120391764551571929374781920485616819465617000",
			addBToA: &expected{
				asHex: "9876D639687B57EAFD8243D16E7D754DE6F315A58F9A40806F36C2BC9EA29381",
				bsHex: "0000820757581283748120391764551571929374781920485616819465617000",
				rc:    0,
			},
			addAToB: &expected{
				asHex: "9876543211234567890123985719203875618230178120381920412839412381",
				bsHex: "9876D639687B57EAFD8243D16E7D754DE6F315A58F9A40806F36C2BC9EA29381",
				rc:    0,
			},
			subAFromB: &expected{
				asHex: "9876543211234567890123985719203875618230178120381920412839412381",
				bsHex: "68892DD54535CD1BEB7FFDA0BF4A35DDFB3011446198FF0F3DF63F6C2C204D7F",
				rc:    0,
			},
			subBFromA: &expected{
				asHex: "9876D22ABACA32E41480025F40B5CA2204CFEEBB9E6700F0C209C093D3DFB280",
				bsHex: "0000820757581283748120391764551571929374781920485616819465617000",
				rc:    0,
			},
			mulAByB: &expected{
				asHex: "00003061CA6B4489B64025B3974A4FA0207E717899153916D15D38C4B727F82B",
				bsHex: "0000820757581283748120391764551571929374781920485616819465617000",
				rc:    0,
			},
			mulBByA: &expected{
				asHex: "9876543211234567890123985719203875618230178120381920412839412381",
				bsHex: "00003061CA6B4489B64025B3974A4FA0207E717899153916D15D38C4B727F82B",
				rc:    0,
			},
			divBByA: &expected{
				asHex: "9876543211234567890123985719203875618230178120381920412839412381",
				bsHex: "0000000000000000000000000000000000000000000000000000000000000000",
				rc:    0,
			},
			divAByB: &expected{
				asHex: "E0FEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
				bsHex: "0000820757581283748120391764551571929374781920485616819465617000",
				rc:    0,
			},
		},
		abTest{
			asHex: "1234567890123456789012345678901234567890123456789012345678901234",
			bsHex: "0987654321098765432109876543210987654321098765432109876543210987",
			MD5AtoB: &expected{
				asHex: "1234567890123456789012345678901234567890123456789012345678901234",
				bsHex: "2FBFBCEC3FAF7CC9F43B45EC82D4EC6087654321098765432109876543210987",
				rc:    0,
			},
			CheckMD5AWithB: &expected{
				asHex: "1234567890123456789012345678901234567890123456789012345678901234",
				bsHex: "0987654321098765432109876543210987654321098765432109876543210987",
				rc:    0,
			},
			SHA256AtoB: &expected{
				asHex: "1234567890123456789012345678901234567890123456789012345678901234",
				bsHex: "CA1194A558362B5FA6E7887DA7B41EC6FAEB01C9477A0AFD46DFC0692BE33482",
				rc:    0,
			},
			CheckSHA256AWithB: &expected{
				asHex: "1234567890123456789012345678901234567890123456789012345678901234",
				bsHex: "0987654321098765432109876543210987654321098765432109876543210987",
				rc:    0,
			},
			Hash160AToB: &expected{
				asHex: "1234567890123456789012345678901234567890123456789012345678901234",
				bsHex: "A5B1C86F10C81C3C543304E9891815D8DE036296098765432109876543210987",
				rc:    0,
			},
			// CheckHash160AWithB *expected
		},
		abTest{
			asHex: "1234567890123456789012345678901234567890123456789012345678901234",
			bsHex: "2FBFBCEC3FAF7CC9F43B45EC82D4EC6087654321098765432109876543210987",
			CheckMD5AWithB: &expected{
				asHex: "1234567890123456789012345678901234567890123456789012345678901234",
				bsHex: "2FBFBCEC3FAF7CC9F43B45EC82D4EC6087654321098765432109876543210987",
				rc:    1,
			},
		},
		abTest{
			asHex: "1234567890123456789012345678901234567890123456789012345678901234",
			bsHex: "CA1194A558362B5FA6E7887DA7B41EC6FAEB01C9477A0AFD46DFC0692BE33482",
			CheckSHA256AWithB: &expected{
				asHex: "1234567890123456789012345678901234567890123456789012345678901234",
				bsHex: "CA1194A558362B5FA6E7887DA7B41EC6FAEB01C9477A0AFD46DFC0692BE33482",
				rc:    1,
			},
		},
		abTest{
			asHex: "1234567890123456789012345678901234567890123456789012345678901234",
			bsHex: "A5B1C86F10C81C3C543304E9891815D8DE036296098765432109876543210987",
			CheckHash160AWithB: &expected{
				asHex: "1234567890123456789012345678901234567890123456789012345678901234",
				bsHex: "A5B1C86F10C81C3C543304E9891815D8DE036296098765432109876543210987",
				rc:    1,
			},
		},
	}
	toPaddedBytes := func(s string) []byte {
		bs, err := hex.DecodeString(s)
		if err != nil {
			panic(err)
		}
		if len(bs) > 32 {
			panic("bs stores more than 32 bytes")
		}
		if len(bs) < 32 {
			padding := make([]byte, 32-len(bs))
			bs = append(padding, bs...)
		}
		return bs
	}
	for _, test := range tests {
		asInit := toPaddedBytes(test.asHex)
		bsInit := toPaddedBytes(test.bsHex)

		s := &stateMachine{}
		initRegisters := func(s *stateMachine) {
			copy(s.as[:], asInit)
			copy(s.bs[:], bsInit)
		}
		runTest := func(e *expected, s *stateMachine, funNum int32) {
			asExp := toPaddedBytes(e.asHex)
			bsExp := toPaddedBytes(e.bsHex)
			initRegisters(s)
			rc := s.fun(funNum)
			assert.Equal(t, e.rc, rc)
			assert.Equal(t, asExp, s.as[:])
			assert.Equal(t, bsExp, s.bs[:])
		}

		initRegisters(s)
		if expected := test.addAToB; expected != nil {
			runTest(expected, s, funAddAToB)
		}
		if expected := test.addBToA; expected != nil {
			runTest(expected, s, funAddBToA)
		}
		if expected := test.subAFromB; expected != nil {
			runTest(expected, s, funSubAFromB)
		}
		if expected := test.subBFromA; expected != nil {
			runTest(expected, s, funSubBFromA)
		}
		if expected := test.mulAByB; expected != nil {
			runTest(expected, s, funMulAByB)
		}
		if expected := test.mulBByA; expected != nil {
			runTest(expected, s, funMulBByA)
		}
		if expected := test.divAByB; expected != nil {
			runTest(expected, s, funDivAByB)
		}
		if expected := test.divBByA; expected != nil {
			runTest(expected, s, funDivBByA)
		}
		if expected := test.MD5AtoB; expected != nil {
			runTest(expected, s, funMD5AtoB)
		}
		if expected := test.CheckMD5AWithB; expected != nil {
			runTest(expected, s, funCheckMD5AWithB)
		}
		if expected := test.SHA256AtoB; expected != nil {
			runTest(expected, s, funSHA256AtoB)
		}
		if expected := test.CheckSHA256AWithB; expected != nil {
			runTest(expected, s, funCheckSHA256AWithB)
		}
		if expected := test.Hash160AToB; expected != nil {
			runTest(expected, s, funHash160AToB)
		}
		if expected := test.CheckHash160AWithB; expected != nil {
			runTest(expected, s, funCheckHash160AWithB)
		}
	}
}
